$baseDir = $env:SPACEFOOT_CONFIGDIR
if ([string]::IsNullOrWhiteSpace($baseDir)) {
    $baseDir = (Get-Location).Path
}

# 1) Config publique depuis Git (déjà téléchargée ou incluse)
$publicPath  = Join-Path $baseDir "config_inventory_public.json"
# 2) Config secrète locale (juste le webhook)
$secretPath  = Join-Path $baseDir "config_inventory_secret.json"

# Lecture config publique
if (!(Test-Path $publicPath)) {
    throw "config_inventory_public.json manquant"
}
$public  = (Get-Content -Raw -Encoding utf8 $publicPath) | ConvertFrom-Json

# Lecture config secrète
if (!(Test-Path $secretPath)) {
    throw "config_inventory_secret.json manquant (webhook)"
}
$secret  = (Get-Content -Raw -Encoding utf8 $secretPath) | ConvertFrom-Json

$webhookUrl = $secret.webhook
$teams      = @($public.teams)
$sites      = @($public.sites)
